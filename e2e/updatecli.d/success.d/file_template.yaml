name: Test file resource with Go template

sources:
  appVersion:
    name: Get application version
    kind: shell
    spec:
      command: echo "1.2.3"
  date:
    name: Get today's date
    kind: shell
    spec:
      command: echo "today"

targets:
  updateVersionFile:
    name: Update version.txt using Go template from file
    kind: file
    spec:
      file: version.txt
      template: templates/version.tmpl
    sourceid: appVersion

  updateConfigWithSprig:
    name: Update config.yaml using Go template with sprig functions from file
    kind: file
    spec:
      file: config.yaml
      template: templates/config.tmpl
    sourceid: appVersion

  templateWithTemplateData:
    name: Update info.txt using Go template with .TemplateData from file
    kind: file
    spec:
      file: release.txt
      template: templates/release.tmpl
      templatedata:
        Environment: Production
        Date: '{{ source "date" }}'
    sourceid: appVersion

